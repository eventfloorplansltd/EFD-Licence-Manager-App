<?phpinclude 'database_connection.php';check_login();if (empty($input['id'])) {    send_error('User ID is required.');}$userId = (int)$input['id'];$updateFields = [];// Use prepared statements to prevent SQL injection$types = "";$params = [];if (isset($input['name'])) {    $updateFields[] = "name = ?";    $types .= "s";    $params[] = $input['name'];}if (isset($input['email'])) {    $updateFields[] = "email = ?";    $types .= "s";    $params[] = $input['email'];}if (isset($input['licenseType'])) {    $updateFields[] = "licenseType = ?";    $types .= "s";    $params[] = $input['licenseType'];}if (isset($input['licenseExpiry'])) {    $updateFields[] = "licenseExpiry = ?";    $types .= "s";    $params[] = $input['licenseExpiry'];}if (count($updateFields) === 0) {    send_error('No fields to update.');}// NEW LOGIC: If license type is changed to "Shared", remove all addons$shouldRemoveAddons = isset($input['licenseType']) && $input['licenseType'] === 'Shared';$conn->begin_transaction();try {    // 1. Update the user    $sql = "UPDATE users SET " . implode(', ', $updateFields) . " WHERE id = ?";    $types .= "i";    $params[] = $userId;        $stmt = $conn->prepare($sql);    $stmt->bind_param($types, ...$params);    $stmt->execute();    $stmt->close();    // 2. If license type was set to Shared, remove addons    if ($shouldRemoveAddons) {        $stmtAddons = $conn->prepare("DELETE FROM user_addons WHERE userId = ?");        $stmtAddons->bind_param("i", $userId);        $stmtAddons->execute();        $stmtAddons->close();    }        // Commit the transaction    $conn->commit();    send_json(['success' => true, 'id' => $userId]);    } catch (mysqli_sql_exception $exception) {    $conn->rollback();    send_error('Error updating user: ' . $exception->getMessage(), 500);}$conn->close();?>